# 首次生成慢的原因说明

## 🔍 为什么第一题生成特别慢？

### 主要原因

1. **DeepSeek Reasoner 模型特性**
   - Reasoner 模型是一个推理模型，需要时间进行深度思考
   - 每次 API 调用通常需要 **10-30 秒**（这是正常的）
   - 模型在分析题目、生成内容、验证逻辑等

2. **多个节点需要调用 API**
   - Router 节点：分析知识点并路由（~5-10秒）
   - Specialist/Finance 节点：生成题目初稿（~10-30秒）
   - Writer 节点：格式化输出（~5-10秒）
   - Critic 节点：审核题目（~10-30秒）
   - **总计：30-80秒是正常的**

3. **首次知识库加载**（仅第一次）
   - 加载 1712 条知识点
   - 加载 408 道历史题目
   - 建立索引和映射
   - 第一次需要 3-5 秒，之后会缓存

### ✅ 已添加的优化

1. **超时设置**
   - 单个 API 调用超时：120秒
   - 避免无限等待

2. **进度提示**
   - 在开始时会显示"正在初始化..."
   - 实时显示每个节点的执行状态
   - 显示日志和进度

3. **知识库缓存**
   - 首次加载后会缓存
   - 后续使用几乎瞬间加载

### 💡 如何判断是否真的卡住了？

**正常情况（不是卡住）**：
- 看到节点名称变化（router → specialist → writer → critic）
- 看到日志输出
- 状态在更新
- 等待时间在 30-80 秒内

**异常情况（可能卡住）**：
- 完全没有输出，超过 2 分钟
- 出现错误信息
- 浏览器显示"加载中"但没有任何更新

### 🚀 优化建议

1. **如果等待时间超过 2 分钟**：
   - 检查网络连接
   - 检查 API Key 是否正确
   - 刷新页面重试

2. **如果想要更快速度**：
   - 可以考虑使用更快的模型（如 `deepseek-chat`）
   - 但质量可能会略有下降

3. **正常使用**：
   - 第一题：30-80 秒（正常）
   - 后续题目：每道题 30-80 秒（正常）
   - 这是 Reasoner 模型的特性，需要时间推理

### 📊 时间分布示例

```
总时间：~60秒（正常）
├── Router: ~8秒
├── Specialist: ~20秒
├── Writer: ~8秒
└── Critic: ~24秒
```

如果看到这些节点依次出现，说明系统正在正常工作！

